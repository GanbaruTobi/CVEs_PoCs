# CVE-2021-27568

## Information about the bug:

[Issue on Github for v1](https://github.com/netplex/json-smart-v1/issues/7)

[Issue on Github for v2](https://github.com/netplex/json-smart-v2/issues/60)

## Compiling and running PoC

```bash
javac -cp json-smart-2.4.jar:accessors-smart-1.3.jar:. PoC_CVE_2021_27568.java

java -cp json-smart-2.4.jar:accessors-smart-1.3.jar:. PoC_CVE_2021_27568
```
## Further Testcases

In the subfolder testable_input are more testcases for the same bug.

## Possible Fix

Rewrite of JSONParserBase.java function to:

```java
protected Number extractFloat() throws ParseException {
		if (!acceptLeadinZero)
		    checkLeadinZero();
		
		try {		
		    if (!useHiPrecisionFloat)
				return Float.parseFloat(xs);
				
		    if (xs.length() > 18) // follow JSonIJ parsing method
				return new BigDecimal(xs);

			return Double.parseDouble(xs); 	 

		} catch(Exception e){
			throw new ParseException(pos, ERROR_UNEXPECTED_TOKEN, xs);	
    } 
}
```

## Repositories containing fix
This can be used till the maintainers fix the issue:

[json-smart-v2](https://github.com/GanbaruTobi/json-smart-v2)

[json-smart-v1](https://github.com/GanbaruTobi/json-smart-v1)
